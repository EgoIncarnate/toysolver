install:
- git submodule init
- git submodule update
- ps: |
    choco install haskellplatform -version 2014.2.0.0 -y
    # Haskell Platfrom package doesn't update PATH for the current shell instance
    $env:Path += ";${env:ProgramFiles}\Haskell Platform\2014.2.0.0\bin"
    $env:Path += ";${env:ProgramFiles}\Haskell Platform\2014.2.0.0\lib\extralibs\bin"
    $env:Path += ";${env:ProgramFiles}\Haskell Platform\2014.2.0.0\mingw\bin"
    $env:Path += ";.\.cabal-sandbox\bin"
- cabal sandbox init
- cabal update
- cabal install --only-dependencies --max-backjumps=-1 --enable-tests --enable-benchmarks --flag=BuildToyFMF --flag=BuildSamplePrograms --flag=BuildMiscPrograms

build_script:
- cabal configure --enable-tests --enable-benchmarks -v2 --flag=BuildToyFMF --flag=BuildSamplePrograms --flag=BuildMiscPrograms # -v2 provides useful information for debugging
- cabal build

test_script:
- cabal test
- cabal check
- cabal sdist
